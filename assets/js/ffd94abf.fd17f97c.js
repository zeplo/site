"use strict";(self.webpackChunk_zeplo_docs=self.webpackChunk_zeplo_docs||[]).push([[6964],{3905:function(e,t,n){n.d(t,{Zo:function(){return p},kt:function(){return m}});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=r.createContext({}),u=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=u(e.components);return r.createElement(s.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),d=u(n),m=a,f=d["".concat(s,".").concat(m)]||d[m]||c[m]||o;return n?r.createElement(f,i(i({ref:t},p),{},{components:n})):r.createElement(f,i({ref:t},p))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,i=new Array(o);i[0]=d;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:a,i[1]=l;for(var u=2;u<o;u++)i[u]=n[u];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},8215:function(e,t,n){n.d(t,{Z:function(){return a}});n(7294);var r=n(6533);function a(e){var t=e.children,n=e.hidden,a=e.className;return(0,r.tZ)("div",{role:"tabpanel",hidden:n,className:a},t)}},9877:function(e,t,n){n.d(t,{Z:function(){return c}});var r=n(7462),a=n(7294),o=n(2389),i=n(5979),l=n(6010),s="tabItem_LplD",u=n(6533);function p(e){var t,n,o,p=e.lazy,c=e.block,d=e.defaultValue,m=e.values,f=e.groupId,h=e.className,v=a.Children.map(e.children,(function(e){if((0,a.isValidElement)(e)&&void 0!==e.props.value)return e;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')})),b=null!=m?m:v.map((function(e){var t=e.props;return{value:t.value,label:t.label,attributes:t.attributes}})),g=(0,i.lx)(b,(function(e,t){return e.value===t.value}));if(g.length>0)throw new Error('Docusaurus error: Duplicate values "'+g.map((function(e){return e.value})).join(", ")+'" found in <Tabs>. Every value needs to be unique.');var y=null===d?d:null!=(t=null!=d?d:null==(n=v.find((function(e){return e.props.default})))?void 0:n.props.value)?t:null==(o=v[0])?void 0:o.props.value;if(null!==y&&!b.some((function(e){return e.value===y})))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+y+'" but none of its children has the corresponding value. Available values are: '+b.map((function(e){return e.value})).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");var k=(0,i.UB)(),w=k.tabGroupChoices,N=k.setTabGroupChoices,O=(0,a.useState)(y),x=O[0],T=O[1],C=[],_=(0,i.o5)().blockElementScrollPositionUntilNextRender;if(null!=f){var Z=w[f];null!=Z&&Z!==x&&b.some((function(e){return e.value===Z}))&&T(Z)}var j=function(e){var t=e.currentTarget,n=C.indexOf(t),r=b[n].value;r!==x&&(_(t),T(r),null!=f&&N(f,r))},q=function(e){var t,n=null;switch(e.key){case"ArrowRight":var r=C.indexOf(e.currentTarget)+1;n=C[r]||C[0];break;case"ArrowLeft":var a=C.indexOf(e.currentTarget)-1;n=C[a]||C[C.length-1]}null==(t=n)||t.focus()};return(0,u.tZ)("div",{className:"tabs-container"},(0,u.tZ)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,l.Z)("tabs",{"tabs--block":c},h)},b.map((function(e){var t=e.value,n=e.label,a=e.attributes;return(0,u.tZ)("li",(0,r.Z)({role:"tab",tabIndex:x===t?0:-1,"aria-selected":x===t,key:t,ref:function(e){return C.push(e)},onKeyDown:q,onFocus:j,onClick:j},a,{className:(0,l.Z)("tabs__item",s,null==a?void 0:a.className,{"tabs__item--active":x===t})}),null!=n?n:t)}))),p?(0,a.cloneElement)(v.filter((function(e){return e.props.value===x}))[0],{className:"margin-vert--md"}):(0,u.tZ)("div",{className:"margin-vert--md"},v.map((function(e,t){return(0,a.cloneElement)(e,{key:t,hidden:e.props.value!==x})}))))}function c(e){var t=(0,o.Z)();return(0,u.tZ)(p,(0,r.Z)({key:String(t)},e))}},4468:function(e,t,n){n.r(t),n.d(t,{assets:function(){return d},contentTitle:function(){return p},default:function(){return h},frontMatter:function(){return u},metadata:function(){return c},toc:function(){return m}});var r=n(7462),a=n(3366),o=(n(7294),n(3905)),i=n(9877),l=n(8215),s=["components"],u={id:"step",title:"Step",sidebar_label:"Step",slug:"/step"},p=void 0,c={unversionedId:"step",id:"step",title:"Step",description:"This feature is currently in ALPHA preview, and must be enabled on your account before use. Please contact hi@zeplo.io if you would like to use this feature.",source:"@site/docs/step.md",sourceDirName:".",slug:"/step",permalink:"/docs/step",editUrl:"https://github.com/zeplo/site/edit/master/docs/step.md",tags:[],version:"current",frontMatter:{id:"step",title:"Step",sidebar_label:"Step",slug:"/step"},sidebar:"someSidebar",previous:{title:"Bulk",permalink:"/docs/bulk"},next:{title:"Tracing",permalink:"/docs/tracing"}},d={},m=[{value:"Creating the stepped flow",id:"creating-the-stepped-flow",level:3},{value:"Using the output from required steps",id:"using-the-output-from-required-steps",level:3}],f={toc:m};function h(e){var t=e.components,u=(0,a.Z)(e,s);return(0,o.kt)("wrapper",(0,r.Z)({},f,u,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"This feature is currently in ",(0,o.kt)("strong",{parentName:"p"},"ALPHA")," preview, and must be enabled on your account before use. Please contact ",(0,o.kt)("a",{parentName:"p",href:"mailto:hi@zeplo.io"},"hi@zeplo.io")," if you would like to use this feature."))),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"/step")," API allows you to send a series of requests in sequence or parallel, and use the response from one request job as the input for another."),(0,o.kt)("p",null,"For example, the following diagram shows some steps that you might want to complete after receiving an order:"),(0,o.kt)("img",{style:{background:"#f1f1f1",maxWidth:"400px",borderRadius:6},src:n(9909).Z,alt:"Steps Flow"}),(0,o.kt)("h3",{id:"creating-the-stepped-flow"},"Creating the stepped flow"),(0,o.kt)("p",null,"In order to achieve this, we must first assign a step name to each of the steps using the ",(0,o.kt)("inlineCode",{parentName:"p"},"_step")," parameter (or ",(0,o.kt)("inlineCode",{parentName:"p"},"X-Zeplo-Step"),"). Each step can then specify which other steps it depends on, by specifying a list of step names using the ",(0,o.kt)("inlineCode",{parentName:"p"},"_requires=A,B")," parameter (or ",(0,o.kt)("inlineCode",{parentName:"p"},"X-Zeplo-Requires"),")."),(0,o.kt)(i.Z,{defaultValue:"js",values:[{label:"JavaScript",value:"js"}],mdxType:"Tabs"},(0,o.kt)(l.Z,{value:"js",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"import axios from 'axios'\n\naxios.post('zeplo.to/step', [{\n  url: 'https://url.com/a?_step=A',\n}, {\n  url: 'https://url.com/b?_step=B&_requires=A',\n}, {\n  url: 'https://url.com/c?_step=C&_requires=A',\n}, {\n  url: 'https://url.com/d?_step=D&_requires=B',\n}, {\n  url: 'https://url.com/e?_step=E&_requires=C,D',\n}, {\n  url: 'https://url.com/f?_requires=E',\n}])\n")))),(0,o.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"You can only send ",(0,o.kt)("inlineCode",{parentName:"p"},"body")," values as JSON or string values for step requests."))),(0,o.kt)("h3",{id:"using-the-output-from-required-steps"},"Using the output from required steps"),(0,o.kt)("p",null,"If you add a ",(0,o.kt)("inlineCode",{parentName:"p"},"_requires")," parameter (or ",(0,o.kt)("inlineCode",{parentName:"p"},"X-Zeplo-Requires")," header), then additional headers will be automatically added in the format ",(0,o.kt)("inlineCode",{parentName:"p"},"X-Zeplo-Step-<step_name>"),". Each header will have the ID of the request job matching the name of the step."),(0,o.kt)("p",null,"For example, if you have a step with the URL ",(0,o.kt)("inlineCode",{parentName:"p"},"https://url.com/e?_step=E&_requires=C,D"),", then you would receive the following two additional headers:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},'X-Zeplo-Step-C: "1ab9797f-db05-48b8-c861-b649115734d9-iow"\nX-Zeplo-Step-D: "30e771cc-c816-413d-c1bb-407234b46ee3-iow"\n')),(0,o.kt)("p",null,"If you want to get the response output for these steps, then you can use the ID from the header and the request API."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"/requests/<id>/response.body\n")))}h.isMDXComponent=!0},9909:function(e,t,n){t.Z=n.p+"assets/images/steps-flow-224ffba6fa961a6995fe625f02b0dc71.png"}}]);